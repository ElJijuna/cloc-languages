name: Web Audit Report
on:
  workflow_dispatch:
    inputs:
      runtime:
        description: 'Runtime to execute report audit, values: npm | bun | pnpm | yarn'
        default: 'npm'
        required: true
        type: string
jobs:
  audit:
    runs-on: ubuntu-latest
    steps:
    - name: ðŸ“¥ Clonar el repositorio
      uses: actions/checkout@v3
    - name: ðŸ”§ Instalar dependencias con npm ci
      run: npm ci
    - name: ðŸ§¨ Executing Script...
      run: curl https://raw.githubusercontent.com/ElJijuna/Bash-Scripts/refs/heads/main/web-audit-report.sh | bash -s npm
  sends-report:
    runs-on: ubuntu-latest
    needs: audit
    steps:
    - name: ðŸ“¥ Cloning
      run: |
        git clone https://github.com/ElJijuna/Npm-Audit-Reports.git
        ls
        cd Npm-Audit-Reports
    - name: ðŸ“¦ Copy report
      run: |
        cp ../cloc_languages.json ./cloc_languages.json
    - name: âœ… Commit & Push
      run: |
        git add cloc_languages.json
        git commit -m "ðŸ“Š Nuevo reporte desde workflow"
        git push
